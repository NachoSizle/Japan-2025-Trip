---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import DayCard from '../components/DayCard.astro';
import itinerarioData from '../data/itinerario.json';

const { dias } = itinerarioData;
---

<Layout title="Itinerario Completo - Jap√≥n 2025">
  <Header />
  <section class="pt-20 sm:pt-24 md:pt-28 pb-12 sm:pb-16 md:pb-20 itinerario-section">
    <div class="container mx-auto px-2 sm:px-4">
      <!-- Header de la secci√≥n -->
      <div class="text-center mb-8 sm:mb-12 md:mb-16">
        <h1 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold font-poppins mb-4 sm:mb-6 md:mb-8 itinerario-title">
          Itinerario Completo
        </h1>
        <p class="text-lg sm:text-xl md:text-2xl itinerario-subtitle max-w-4xl mx-auto mb-6 sm:mb-8 md:mb-10 px-2 sm:px-4">
          Explora d√≠a a d√≠a nuestra aventura de 15 d√≠as por Jap√≥n, con todos los detalles de cada actividad y opciones especiales para cel√≠acos.
        </p>
        
        <!-- Informaci√≥n del viaje -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 md:gap-8 max-w-2xl mx-auto mb-8 sm:mb-10 md:mb-12">
          <div class="trip-info-card p-4 sm:p-6 rounded-xl">
            <div class="text-2xl sm:text-3xl mb-2">üóìÔ∏è</div>
            <div class="font-bold text-lg sm:text-xl mb-1" style="color: #FF1493;">
              {itinerarioData.viaje.duracion_dias} d√≠as
            </div>
            <div class="text-sm text-gray-400">Duraci√≥n total</div>
          </div>
          <div class="trip-info-card p-4 sm:p-6 rounded-xl">
            <div class="text-2xl sm:text-3xl mb-2">üèôÔ∏è</div>
            <div class="font-bold text-lg sm:text-xl mb-1" style="color: #FF6B6B;">
              {itinerarioData.viaje.ciudades_principales.length} ciudades
            </div>
            <div class="text-sm text-gray-400">Principales</div>
          </div>
          <div class="trip-info-card p-4 sm:p-6 rounded-xl sm:col-span-1">
            <div class="text-2xl sm:text-3xl mb-2">üåæüö´</div>
            <div class="font-bold text-lg sm:text-xl mb-1" style="color: #FF0040;">
              {dias.reduce((total, dia) => total + dia.actividades.filter(a => (a as any).gluten_free).length, 0)} opciones
            </div>
            <div class="text-sm text-gray-400">Sin gluten</div>
          </div>
        </div>
      </div>

      <!-- Filtros optimizados para m√≥vil -->
      <div class="flex flex-wrap justify-center gap-1 sm:gap-2 md:gap-4 mb-8 sm:mb-10 md:mb-12 px-2" x-data="{ activeFilter: 'todos' }">
        <button 
          @click="activeFilter = 'todos'" 
          :class="activeFilter === 'todos' ? 'filter-active-primary' : 'filter-inactive-primary'"
          class="px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 border-2 rounded-full font-medium transition-all duration-300 text-xs sm:text-sm whitespace-nowrap flex-shrink-0">
          Todos los d√≠as
        </button>
        <button 
          @click="activeFilter = 'gluten-free'" 
          :class="activeFilter === 'gluten-free' ? 'filter-active-gluten' : 'filter-inactive-gluten'"
          class="px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 border-2 rounded-full font-medium transition-all duration-300 text-xs sm:text-sm whitespace-nowrap flex-shrink-0">
          üåæüö´ Sin Gluten
        </button>
        <button 
          @click="activeFilter = 'destacados'" 
          :class="activeFilter === 'destacados' ? 'filter-active-featured' : 'filter-inactive-featured'"
          class="px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 border-2 rounded-full font-medium transition-all duration-300 text-xs sm:text-sm whitespace-nowrap flex-shrink-0">
          ‚≠ê Destacados
        </button>
        <button 
          @click="activeFilter = 'turismo'" 
          :class="activeFilter === 'turismo' ? 'filter-active-tourism' : 'filter-inactive-tourism'"
          class="px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 border-2 rounded-full font-medium transition-all duration-300 text-xs sm:text-sm whitespace-nowrap flex-shrink-0">
          üóº Turismo
        </button>
      </div>

      <!-- Itinerario completo -->
      <div class="space-y-6 sm:space-y-8 md:space-y-12">
        {dias.map((dia, index) => {
          // Crear atributos data para que Alpine.js pueda usarlos
          const hasGlutenFree = dia.actividades.some((act) => (act as any).gluten_free === true);
          const hasDestacado = dia.actividades.some((act) => (act as any).destacado === true);
          const hasTurismo = dia.actividades.some((act) => (act as any).tipo === 'turismo');
          
          return (
            <div 
              class="relative max-w-2xl mx-auto"
              x-show={`
                activeFilter === 'todos' || 
                (activeFilter === 'gluten-free' && ${hasGlutenFree}) ||
                (activeFilter === 'destacados' && ${hasDestacado}) ||
                (activeFilter === 'turismo' && ${hasTurismo})
              `}
              x-transition:enter="transition ease-out duration-300"
              x-transition:enter-start="opacity-0 transform scale-95"
              x-transition:enter-end="opacity-100 transform scale-100"
              x-transition:leave="transition ease-in duration-200"
              x-transition:leave-start="opacity-100 transform scale-100"
              x-transition:leave-end="opacity-0 transform scale-95">
              
              <!-- Enlace a p√°gina individual del d√≠a -->
              <a href={`${import.meta.env.BASE_URL}/itinerario/${dia.dia}`} class="block group">
                <DayCard 
                  day={dia.dia}
                  fecha={dia.fecha}
                  titulo={dia.titulo}
                  ciudad={dia.ciudad}
                  actividades={dia.actividades as any}
                />
                <!-- Indicador de que es clickeable -->
                <div class="mt-3 transition-colors duration-300 text-center">
                  <span class="text-sm clickable-hint group-hover:text-pink-400">
                    üëÜ Ver detalles completos del d√≠a {dia.dia}
                  </span>
                </div>
              </a>
            </div>
          );
        })}
      </div>

      <!-- CTA de regreso al home -->
      <div class="text-center mt-12 sm:mt-16 md:mt-20 px-2 sm:px-4">
        <a href="/" class="home-cta inline-flex items-center justify-center space-x-3 px-8 sm:px-10 py-4 sm:py-5 rounded-xl font-bold transition-all duration-300 transform hover:scale-105 text-base sm:text-lg">
          <span class="text-xl">üè†</span>
          <span>Volver al Inicio</span>
          <span class="text-xl">‚ú®</span>
        </a>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* Itinerario Section */
  .itinerario-section {
    background: linear-gradient(135deg, #1a1a1a 0%, #2d1b3d 100%);
    min-height: 100vh;
    position: relative;
  }
  
  :global([data-theme="light"]) .itinerario-section {
    background: linear-gradient(135deg, #FFE8E8 0%, #FFDDDD 100%) !important;
  }

  /* Itinerario Title */
  .itinerario-title {
    background: linear-gradient(135deg, #FF1493, #FF6B6B, #FF0040);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 0 30px rgba(255, 20, 147, 0.5);
  }

  /* Itinerario Subtitle */
  .itinerario-subtitle {
    color: rgba(255, 255, 255, 0.8);
  }
  
  :global([data-theme="light"]) .itinerario-title {
    background: linear-gradient(135deg, #C41E3A, #DC143C, #8B0000) !important;
    -webkit-background-clip: text !important;
    background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    text-shadow: none !important;
  }
  
  :global([data-theme="light"]) .itinerario-subtitle {
    color: #2D1B1B !important;
    font-weight: 600;
    opacity: 0.95;
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
  }

  /* Trip Info Cards */
  .trip-info-card {
    background: rgba(255, 20, 147, 0.1);
    border: 1px solid rgba(255, 20, 147, 0.3);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
  }
  
  .trip-info-card:hover {
    border-color: rgba(255, 20, 147, 0.5);
    box-shadow: 0 8px 32px rgba(255, 20, 147, 0.2);
    transform: translateY(-2px);
  }
  
  :global([data-theme="light"]) .trip-info-card {
    background: rgba(255, 20, 147, 0.05);
    border: 1px solid rgba(255, 20, 147, 0.2);
  }
  
  :global([data-theme="light"]) .trip-info-card:hover {
    background: rgba(255, 20, 147, 0.1);
    border-color: rgba(255, 20, 147, 0.4);
  }

  /* Filter Buttons - Reutilizando estilos del Timeline */
  .filter-active-primary {
    background: #FF1493 !important;
    color: white !important;
    border-color: #FF1493 !important;
    box-shadow: 0 0 20px rgba(255, 20, 147, 0.6);
  }

  .filter-inactive-primary {
    background: transparent !important;
    color: #FF1493 !important;
    border-color: #FF1493 !important;
  }
  
  .filter-inactive-primary:hover {
    box-shadow: 0 0 20px rgba(255, 20, 147, 0.4);
  }
  
  :global([data-theme="light"]) .filter-active-primary {
    background: #DC143C !important;
    color: white !important;
    border-color: #DC143C !important;
    box-shadow: 0 0 15px rgba(220, 20, 60, 0.4);
  }

  :global([data-theme="light"]) .filter-inactive-primary {
    background: rgba(255, 245, 245, 0.7) !important;
    color: #C41E3A !important;
    border-color: #C41E3A !important;
  }

  .filter-active-gluten {
    background: #FF6B6B !important;
    color: white !important;
    border-color: #FF6B6B !important;
    box-shadow: 0 0 20px rgba(255, 107, 107, 0.6);
  }

  .filter-inactive-gluten {
    background: transparent !important;
    color: #FF6B6B !important;
    border-color: #FF6B6B !important;
  }
  
  .filter-inactive-gluten:hover {
    box-shadow: 0 0 20px rgba(255, 107, 107, 0.4);
  }

  .filter-active-featured {
    background: #FF0040 !important;
    color: white !important;
    border-color: #FF0040 !important;
    box-shadow: 0 0 20px rgba(255, 0, 64, 0.6);
  }

  .filter-inactive-featured {
    background: transparent !important;
    color: #FF0040 !important;
    border-color: #FF0040 !important;
  }
  
  .filter-inactive-featured:hover {
    box-shadow: 0 0 20px rgba(255, 0, 64, 0.4);
  }

  .filter-active-tourism {
    background: #FF8A80 !important;
    color: #1a1a1a !important;
    border-color: #FF8A80 !important;
    box-shadow: 0 0 20px rgba(255, 138, 128, 0.6);
  }

  .filter-inactive-tourism {
    background: transparent !important;
    color: #FF8A80 !important;
    border-color: #FF8A80 !important;
  }
  
  .filter-inactive-tourism:hover {
    box-shadow: 0 0 20px rgba(255, 138, 128, 0.4);
  }

  /* Home CTA Button */
  .home-cta {
    background: linear-gradient(135deg, #FF6B6B, #FF1493);
    color: white;
    box-shadow: 0 8px 32px rgba(255, 20, 147, 0.3);
    border: 2px solid rgba(255, 255, 255, 0.1);
  }
  
  .home-cta:hover {
    box-shadow: 0 12px 40px rgba(255, 20, 147, 0.5);
    border-color: rgba(255, 255, 255, 0.2);
  }
  
  :global([data-theme="light"]) .home-cta {
    background: linear-gradient(135deg, #FF6B6B, #DC143C);
    box-shadow: 0 8px 32px rgba(220, 20, 60, 0.3);
  }

  /* Clickable Hint */
  .clickable-hint {
    color: rgba(255, 255, 255, 0.5);
  }
  
  :global([data-theme="light"]) .clickable-hint {
    color: #4b5563 !important;
    font-weight: 500;
  }

  /* Alpine.js transitions */
  [x-cloak] {
    display: none !important;
  }
</style>
