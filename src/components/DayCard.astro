---
export interface Props {
  day: number;
  fecha: string;
  titulo: string;
  ciudad: string;
  actividades: Array<{
    hora: string;
    actividad: string;
    ubicacion: string;
    tipo: string;
    gluten_free?: boolean;
    destacado?: boolean;
    alternativa_gf?: string;
    notas?: string;
    direccion?: string;
    maps_url?: string;
  }>;
}

const { day, fecha, titulo, ciudad, actividades } = Astro.props as Props;

// Funci√≥n para obtener el icono seg√∫n el tipo de actividad
function getActivityIcon(tipo: string) {
  const icons: Record<string, string> = {
    'transporte': '‚úàÔ∏è',
    'alojamiento': 'üè®',
    'comida': 'üçΩÔ∏è',
    'turismo': 'üóº',
    'cultura': 'üèØ',
    'naturaleza': 'üå∏'
  };
  return icons[tipo] || 'üìç';
}

// Funci√≥n para obtener color seg√∫n el tipo
function getActivityColor(tipo: string) {
  const colors: Record<string, string> = {
    'transporte': 'daycard-activity-transport',
    'alojamiento': 'daycard-activity-hotel',
    'comida': 'daycard-activity-food',
    'turismo': 'daycard-activity-tourism',
    'cultura': 'daycard-activity-culture',
    'naturaleza': 'daycard-activity-nature'
  };
  return colors[tipo] || 'daycard-activity-default';
}
---

<div class="daycard-container backdrop-blur-sm rounded-xl p-3 sm:p-4 md:p-6 transition-all duration-300 group">
  <!-- Header del d√≠a -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-4 md:mb-6">
    <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 md:gap-4">
      <span class="daycard-day-number text-base sm:text-lg md:text-xl font-bold">D√≠a {day}</span>
      <span class="daycard-date text-xs sm:text-sm md:text-base font-mono">{fecha}</span>
      <span class="daycard-city text-xs sm:text-sm md:text-base font-semibold">{ciudad}</span>
    </div>
  </div>

  <div class="mb-3 sm:mb-4">
    <h3 class="daycard-title text-lg sm:text-xl md:text-2xl font-bold mb-2">{titulo}</h3>
  </div>

  <!-- Lista de actividades optimizada para m√≥vil -->
  <div class="space-y-2 sm:space-y-3 md:space-y-4">
    {actividades.map((act) => (
      <div class={`flex items-start gap-2 sm:gap-3 md:gap-4 p-2 sm:p-3 md:p-4 rounded-lg border-l-4 ${getActivityColor(act.tipo)} daycard-activity`}>
        <div class="text-lg sm:text-xl md:text-2xl flex-shrink-0 mt-0.5">{getActivityIcon(act.tipo)}</div>
        <div class="flex-1 min-w-0 overflow-hidden">
          <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 mb-1 sm:mb-2">
            <span class="daycard-activity-name font-bold text-sm sm:text-base md:text-lg break-words">{act.actividad}</span>
            <div class="flex items-center gap-1 sm:gap-2 flex-wrap">
              {act.gluten_free && <span class="daycard-badge-gf px-1.5 sm:px-2 py-0.5 sm:py-1 rounded font-semibold text-xs whitespace-nowrap">üåæüö´ GF</span>}
              {act.destacado && <span class="daycard-badge-featured px-1.5 sm:px-2 py-0.5 sm:py-1 rounded font-semibold text-xs whitespace-nowrap">‚≠ê</span>}
            </div>
          </div>
          <div class="daycard-activity-details text-xs sm:text-sm font-mono break-words overflow-hidden text-ellipsis">
            {act.hora} ‚Ä¢ 
            {act.maps_url ? (
              <a href={act.maps_url} target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition-colors duration-200">
                üìç {act.ubicacion}
              </a>
            ) : (
              act.ubicacion
            )}
          </div>
          {act.direccion && <div class="daycard-address text-xs mt-1 font-mono break-words opacity-75">üè† {act.direccion}</div>}
          {act.alternativa_gf && <div class="daycard-gf-alternative text-xs mt-1 break-words">{act.alternativa_gf}</div>}
          {act.notas && <div class="daycard-notes text-xs mt-1 italic break-words">{act.notas}</div>}
        </div>
      </div>
    ))}
  </div>
</div>

<style>
  /* ===== ELIMINAR SUBRAYADOS DE TODOS LOS ELEMENTOS ===== */
  a {
    text-decoration: none !important;
  }
  
  a:hover {
    text-decoration: none !important;
  }
  
  a:focus {
    text-decoration: none !important;
  }
  
  a:active {
    text-decoration: none !important;
  }
  
  a:visited {
    text-decoration: none !important;
  }
  
  /* Asegurar que ning√∫n texto tenga subrayado */
  * {
    text-decoration: none !important;
    text-decoration-line: none !important;
    border-bottom: none !important;
    box-shadow: none !important;
  }
  
  /* Eliminar cualquier estilo de Tailwind que pueda causar subrayado */
  .daycard-container * {
    text-decoration: none !important;
    text-decoration-line: none !important;
    text-decoration-style: none !important;
    text-decoration-color: transparent !important;
    border-bottom: none !important;
    border-bottom-width: 0 !important;
    border-bottom-style: none !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  
  /* ===== ELIMINACI√ìN S√öPER AGRESIVA DE SUBRAYADOS ===== */
  /* Eliminar cualquier posible subrayado causado por Tailwind, navegador o herencia */
  .daycard-container,
  .daycard-container *,
  .daycard-container *:before,
  .daycard-container *:after {
    text-decoration: none !important;
    text-decoration-line: none !important;
    text-decoration-style: none !important;
    text-decoration-color: transparent !important;
    text-decoration-thickness: 0 !important;
    text-underline-offset: 0 !important;
    text-underline-position: unset !important;
    border-bottom: none !important;
    border-bottom-width: 0 !important;
    border-bottom-style: none !important;
    border-bottom-color: transparent !important;
    outline: none !important;
    box-shadow: none !important;
  }
  
  /* Estados de interacci√≥n */
  .daycard-container *:hover,
  .daycard-container *:focus,
  .daycard-container *:active,
  .daycard-container *:visited {
    text-decoration: none !important;
    text-decoration-line: none !important;
    text-decoration-style: none !important;
    text-decoration-color: transparent !important;
    text-decoration-thickness: 0 !important;
    text-underline-offset: 0 !important;
    border-bottom: none !important;
    border-bottom-width: 0 !important;
    border-bottom-style: none !important;
    border-bottom-color: transparent !important;
    outline: none !important;
    box-shadow: none !important;
  }
  
  /* Eliminar pseudo-elementos que puedan crear l√≠neas */
  .daycard-container *::before,
  .daycard-container *::after {
    content: none !important;
    display: none !important;
    border: none !important;
    background: none !important;
    box-shadow: none !important;
  }
  
  /* DayCard Container */
  .daycard-container {
    background: rgba(255, 20, 147, 0.08);
    border: 1px solid rgba(255, 20, 147, 0.3);
    backdrop-filter: blur(10px);
  }
  
  .daycard-container:hover {
    border-color: rgba(255, 20, 147, 0.5);
    box-shadow: 0 8px 32px rgba(255, 20, 147, 0.2);
  }
  
  [data-theme="light"] .daycard-container {
    background: rgba(255, 20, 147, 0.05);
    border: 1px solid rgba(255, 20, 147, 0.2);
  }
  
  [data-theme="light"] .daycard-container:hover {
    background: rgba(255, 20, 147, 0.1);
    border-color: rgba(255, 20, 147, 0.4);
  }

  /* Day Number */
  .daycard-day-number {
    color: #FF1493;
    text-decoration: none !important;
    text-shadow: none !important;
  }

  /* Date */
  .daycard-date {
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none !important;
  }
  
  [data-theme="light"] .daycard-date {
    color: #4b5563 !important;
    font-weight: 500;
  }

  /* City */
  .daycard-city {
    color: #FF6B6B;
    text-decoration: none !important;
    text-shadow: none !important;
  }

  /* Title */
  .daycard-title {
    background: linear-gradient(135deg, #FF1493, #FF6B6B);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-decoration: none !important;
  }

  /* Activity Container */
  .daycard-activity {
    background: rgba(0, 0, 0, 0.3);
  }
  
  [data-theme="light"] .daycard-activity {
    background: rgba(255, 255, 255, 0.5);
  }

  /* Activity Types */
  .daycard-activity-transport {
    border-left-color: #FF6B6B !important;
  }

  .daycard-activity-hotel {
    border-left-color: #FF8A80 !important;
  }

  .daycard-activity-food {
    border-left-color: #FF0040 !important;
  }

  .daycard-activity-tourism {
    border-left-color: #FF1493 !important;
  }

  .daycard-activity-culture {
    border-left-color: #FF8A80 !important;
  }

  .daycard-activity-nature {
    border-left-color: #FFB3BA !important;
  }

  .daycard-activity-default {
    border-left-color: #FF6B6B !important;
  }

  /* Activity Name */
  .daycard-activity-name {
    color: white;
    text-decoration: none !important;
  }
  
  [data-theme="light"] .daycard-activity-name {
    color: #1a1a1a !important;
    font-weight: 600;
  }

  /* Activity Details */
  .daycard-activity-details {
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none !important;
  }
  
  [data-theme="light"] .daycard-activity-details {
    color: #2d2d2d !important;
    font-weight: 500;
  }

  /* Badges */
  .daycard-badge-gf {
    background: #FF8A80;
    color: white;
    text-decoration: none !important;
    text-shadow: none !important;
    border-bottom: none !important;
    box-shadow: none !important;
  }

  .daycard-badge-featured {
    background: #FF1493;
    color: white;
    text-decoration: none !important;
    text-shadow: none !important;
    border-bottom: none !important;
    box-shadow: none !important;
  }

  /* GF Alternative */
  .daycard-gf-alternative {
    color: #FF8A80;
    text-decoration: none !important;
  }

  /* Notes */
  .daycard-notes {
    color: rgba(255, 255, 255, 0.6);
    text-decoration: none !important;
  }
  
  [data-theme="light"] .daycard-notes {
    color: #4b5563 !important;
    font-weight: 500;
    opacity: 0.9;
    text-decoration: none !important;
  }
  
  /* ===== CLASES DE UTILIDAD PARA NO SUBRAYADO ===== */
  .no-underline {
    text-decoration: none !important;
  }
  
  .no-underline:hover {
    text-decoration: none !important;
  }
  
  /* Asegurar que span, div, p no tengan subrayado */
  span, div, p, h1, h2, h3, h4, h5, h6 {
    text-decoration: none !important;
  }

  /* ===== ESTILOS ESPEC√çFICOS PARA GOOGLE MAPS Y DIRECCIONES ===== */
  .daycard-address {
    color: #888888;
    font-family: monospace;
  }

  :global([data-theme="light"]) .daycard-address {
    color: #666666;
  }

  /* Enlaces de Google Maps */
  .daycard-activity-details a {
    text-decoration: none !important;
    transition: color 0.2s ease;
  }

  .daycard-activity-details a:hover {
    text-decoration: none !important;
    color: #60A5FA !important;
  }

  :global([data-theme="light"]) .daycard-activity-details a:hover {
    color: #3B82F6 !important;
  }

  /* ===== ESTILOS ADICIONALES PARA MODO CLARO ===== */
  
  /* Contenedor principal en modo claro */
  :global([data-theme="light"]) .daycard-container {
    background: rgba(255, 245, 245, 0.9) !important;
    border: 2px solid rgba(255, 107, 107, 0.3) !important;
  }
  
  :global([data-theme="light"]) .daycard-container:hover {
    border-color: rgba(220, 20, 60, 0.5) !important;
    box-shadow: 0 8px 32px rgba(220, 20, 60, 0.2) !important;
  }
  
  /* Actividades en modo claro */
  :global([data-theme="light"]) .daycard-activity {
    background: rgba(255, 240, 240, 0.8) !important;
    border-left-width: 4px;
  }
  
  /* Textos principales m√°s oscuros */
  :global([data-theme="light"]) .daycard-day-number,
  :global([data-theme="light"]) .daycard-city,
  :global([data-theme="light"]) .daycard-title {
    color: #C41E3A !important;
    text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5) !important;
  }
  
  :global([data-theme="light"]) .daycard-date {
    color: #5D4A4A !important;
    font-weight: 600;
  }
  
  :global([data-theme="light"]) .daycard-activity-name {
    color: #2D1B1B !important;
    font-weight: 700;
  }
  
  :global([data-theme="light"]) .daycard-activity-details {
    color: #5D4A4A !important;
    font-weight: 600;
  }
  
  :global([data-theme="light"]) .daycard-notes {
    color: #5D4A4A !important;
    font-weight: 600;
    opacity: 0.9;
  }
</style>
